# (ADVANCED) Guide to Overclocked LSDj by Infu

Chapters are ordered as it follows:

1. History and the Benefits of Overclocking Nowadays
2. How to Overclock LSDj ROM
3. Amplitude Modulation Synthesis - Overclocking Hum
4. Workflow changes (Groove/Tempo/BPM relation)
5. CPU usage
6. Controlling the Extra Hum
7. Hum Pitch table
8. Quickstart mini guide
9. WAV channel
10. Another look at the tables
11. LSDj Version Overclock differrence

[NOTE: **This guide as for now is a bit unfinished**, and multiple examples are coming very soon]

## History and the Benefits of Overclocking Nowadays

**History** of Software overclocking LSDj starts by Pain Perdu in 2017 using version 5.3.5.[(Archived link for the article here)](https://web.archive.org/web/20200601005830/https://chiptuneswin.com/blog/pauls-tech-talk-lsdj-5-3-5_4x-part-2-sandpaper-vs-eardrums/) 
Results were impressive, but due to heavier CPU usage while overclocked,
users would experience serious drawbacks,
making usage less than desirable.
*However*, version 8 improved dramatically in those terms,
and now, even in heavy modulation situations where previous versions would slow down,
there's no hint of slowdown!
Consequently, overclocking LSDj from version 8 onwards should be more than pleasureable experience,
providing much greater headroom than previous versions!

**Benefits** of Software Overclocking LSDj are new wicked types of sound design,
enabling multitimbrality on each channel and amplitude modulation synthesis!
Overclocked LSDj will play any of your non-OC saves four times faster:
4x speed of LSDj engine means that every table modulation, grooves, and whole sequencer will play four times faster.
It will require something stronger CPU-wise than an original model GameBoy
(GameBoy Color, GameBoy Advance, or an emulator like BGB for the best results),
though no hardware mods are required at all!
The guide below will explain many tips and tricks regarding overclocking,
but it is designed for advanced LSDj users who are confident in normal LSDj operation and seek to get out more out of it.

**Warning**: Even though my guide should help you with your OC experience,
keep in mind that developer doens't support this technique,
and might not be able to help you in case song-breaking glitch happens
(though my experience has been very stable with this overclocking, putting the word of caution out)

*Another note: all notes below were observed while using BGB emulator on Windows.
Experience on other platforms may wary, but I'll be more than happy to expand the guide with
notes from other platforms.*

## How to Overclock LSDj ROM:
Modifying your ROM to be overclocked is actually fairly easy, possible to do on any platform that has hex Editor.<br>
This will not affect any other data of LSDj: your kits, palettes, all are safe.<br>
Still, remember to backup your ROM before you modify your precious tracker!

**`To benefit fully from this guide please use LSDj version above v8`**
  ![HxD_2Searching2](https://user-images.githubusercontent.com/66220663/99159166-2aeb8d80-26d2-11eb-8b4a-74b31f4879d6.png)   
  *(picture showcasing step 2)*
  
**Step by step instructions:**
1. Open up your LSDj ROM in the hex editor of your choice (I used HxD on Windows);
  2. Search *hex-value* string **`3E04E007`**;
  3. Replace it with **`3E07E007`**; (Notice: We are changing esensially only second value `04` to `07`)
  4. Save;

Your LSDj's tempo should be *multiplied* by **four** now!

###    Amplitude Modulation Synthesis - Overclocking Hum

[VIDEO BE HERE]
The magic of overclocking is largely dependant on LSDj's **`TEMPO`** parameter.
It's responsible for LSDj's engine speed, therefore increasing it will speed up all modulation happening,
and slowing it down will make your tables much slower.
When performing extremely rapid modulation (high tempo) of particular commands/effects
(for example: a table with **"O`--`"**, **"O`LR`"** and **"H`00`"**)
**a hum of a specific pitch will be produced**!<br>
It happens because of Gameboy's natural behavior:<br>
while switching between **"`E`"**, **"`O`"** or **"`W`"** command, a click happens
which when done in rapid succession generates the hum you can hear.
This hum is generated with *Amplitude Modulation* synthesis, (or simply, AM synthesis)
which can be thought of as an extra oscillator in the channel.

AM synthesis, in the context of LSDj, works by rapidly changing volume, note or pulse width at a certain frequency.
This frequency is generated by  placing mentioned above commands in the Table.
The **Table speed** is dependent on the **`TEMPO`** parameter,
but the actual produced **Hum frequency** is dependent on how long the modulation is.
The higher the tempo, the faster the table will be cycled through,
thus the higher the initial pitch.
*Initial*, because you can achieve even more by manipulating the table by increasing/decreasing the **"OFF/O`--`"** time.

Said hum does not come out of nowhere, but shares the channel together with other sounds happening there,
each one "fighting each other, and one may strip other from some frequencies to fit in, which is absolutely normal behaviour,
and you can design your sounds around that, giving one or the other more priority.

# Workflow changes 

There's multiple differences between normal stock LSDj and overclocked one that you'll need to get used to,
especially when transferring your previous songs and using them there.
Major change in OC version is that whole LSDJ **`TEMPO`** is multiplied by 4.
That means that your standard 6tick-Groove song tempo 150 will play like it was 600!<br>
Because tempo is tied to many parameters, you need to adjust your:

![bgb_Uf0q7VEqT3](https://user-images.githubusercontent.com/66220663/99181572-27362600-2727-11eb-8884-2d84d3aff9fe.png)

- Grooves;
- Tables (Placing appropiate **"`G`"** command somewhere inside them so your modulation plays correctly);
- Commands like D,K,R,W;
- Instrument Command rate;
- Wave instrument speeds;

Because the tempo dictates the actual pitch of the hum,
you will find yourself adjusting **`TEMPO`** to achieve desired pitch,
so you need to separate the **`TEMPO = BPM`** workflow.
Instead, to actually achieve BPM you want (or precisely tell which one you're using) use following formula:<br>
**`BPM = (Tempo x 96)/[4 rows of your groove setting]`**<br>
[Note: 96 comes from having default 6 ticks per step groove, times 4 to achieve `ticks per beat`(24),
then times 4 to reach actual value that OverClocked LSDj is using (96)]
*A good practice* is to make sure your grooves are divisible by two in order to achieve half tempo if desired.

It is highly recommended to use GBC and above for optimal performance,
but it's doable to run simpler/slower songs on normal DMG as well!

If you thought about using **2xOC-LSDj** synced together, don't expect a lot of stability -
Intense moments in your songs will slightly desync them, very high **`TEMPO`** should be avoided to prevent that.
For some reason I cannot start start all 8 channels at once on some songs, still investigating that.

Also small note, as for now, using official LSDj patcher and upgrading ROM will overwrite the overclock,
making you redo the process in hex editor, but that's not big issue!

### CPU USAGE

Overclocking can be very taxing on the Gameboy's CPU, and reaching the "TOO BUSY!" state is more than easy.
The faster the **"`TEMPO`"**, the faster the modulation, therefore CPU has to work harder to keep up.
If you're maintaining high **"`TEMPO`"** and using multiple effects/techniques playing at once
this can lead to sequencer desync, or crash Gameboy/LSDj! Here's couple factors I noticed:
* **"`E`"** command next to **"`V`"** are most CPU taxing commands.
* **"`O`"** and **"`W`"** don't put as much pressure.
* The **"`V`"** command is much more resource intensive than having transpose done in the table, no matter how intense the modulation is;
* Longer tables are easier on the CPU;
* Slower songs are also easier for CPU;
* If you can, try to end tables with **"A`20`"** instead of **"`H`"**-opping over nothingness;


# Controlling the Extra Hum

Commands below enable you to create extra Hum sharing the channel you're using it on.<br>
How it works:<br>
![4steps](https://user-images.githubusercontent.com/66220663/99159359-7d797980-26d3-11eb-81c8-619667eec1bb.png)<br>
*(picture showing 4 step modulation)*<br>
The length of the modulation will decide the pitch of the hum.
Minimal usable modulation is 2 step one, using **`O`** command as an example:<br>
0_00_00 **O**`LR`<br>
1_00_00 **O**`--`<br>
2_00_00 **H**`00`<br>
where modulation takes 2 steps, and on 3rd one we **`H`**-op to the beginning of our table.<br>
Use loops like **"H`10`"** to achieve modulation in between rows.
[A command here]
[More explaination coming soon:]

# Hum Pitch table

## **"`O`"** command (any channel)

**"`O`"** command generates hum **idependently** from the instrument's ADSR.<br>
Note may be silent, but as long as instrument is still on, the *hum will continue*.<br>
Can be stopped when you change instrument, **"`K`"** ill it or direct it to **"A`20`"**.<br>
Hum will even appear if you pan left or right side, creating stereo hum.<br>
**"`O`"** command hum will duck in the volume if wave width is set to 75%, therefore **works best with wave width 12.5%**<br>
The **"`O`"** command may be used on **any** channel you like.<br>
One of the ways to control the hum's volume is to move around the steps where the **"`O`"** is active and where it's not.<br>
Another way to look at the hum effect, think that every **"O`LR`"** step represents square wave at it's top,
and every **"O`--`"** is square at it's bottom.<br>

## **"`W`"** command (pulse channels only)

**"`W`"** command generates hum **tied to** instrument's ADSR.<br>
If your note goes silent, the *hum will go silent too*.<br>
Changing from thin to wide waveform will result in the loudest and grittiest hum.<br>
Adjust the width to your liking. **"`W`"** command also will produce high overtones that sounds like clicking.

## **"`E`"** command (any channel)

**"`E`"** command generates hum **overwriting** instrument's ADSR.<br>
Hum will be louder as the distance between lowest and highest **"`E`"** command values rises.<br>
**Works best on the wave width 75%**

## **"`R`"** command (any channel)

Use **"R`00-0F`"** in phrase to retrigger the long hum tables,
giving you additional control over them without changing the table itself!<br>
First F digits of **"`R`"** commands will play the table up to chosen digit of the command
(i.e. **"R`04`"** will play first 4 steps of the table and *hop* back to the beginning)

## Transpose

Using the transpose column in the table with minimum 2 step modulation will split the instrument pitch into 3,
creating FM-like metallic sound.<br>
3, because you have *Transposed* step next to another one (can be transposed or not) AND *tempo dependant hum* inbetween!

## **"`T`"** command

LSDj allows the user to change the engine tempo on the fly using the **"`T`"** command.
This affects the entire sequencer, therefore affecting the overclock hum pitch.
The problem is that whole sequencer needs to be properly adjusted for this to work.
Though I haven't done it properly myself, I think that grooves will do the work correctly!
Because we are overclocking quite high,
I think we could accurately adjust groove to the song, or make it swing a bit but still fit the song.
I would recommend placing extra **"`G`"** commands before **"`T`"** in order to even out the tempo change,
(pre **"`T`"** groove with old and new groove timing for the smoothest effect -
placing new groove before/after tempo change can make song hiccup for a brief moment)
and put the new proper groove in all patterns when there's an empty space in the sequencer.

# Multihum
![Multihum](https://user-images.githubusercontent.com/66220663/99159315-3c816500-26d3-11eb-906d-056e685d55c1.png)<br>
Using combinations of **"`W`"** and **"`O`"** can yeld you multiple hums,
but beware that this technique makes the tuning even more difficult, and is extra taxing on the CPU.
Adding Transpose in the table adds ever more harmonics.
When using both **"`W`"** and **"`O`"** commands, make sure the *active* **"O`LR`"** commands hit thinner waves if we want the hum to be quieter.

# Quickstart mini guide
Summing all what was mentioned above, I will quickly present step by step first couple steps to achieve Overclocking Hum, and play around with it:
[step by step guide here:]

# WAV Channel

Original guide from Pain Perdu never included the WAV channel possibilities,
and in the beginning I was sceptical to even put much modulation there
because it's already really powerful on its own, but here is something I discovered:
giving O to Kick creates "distortion"

## Another look at the tables
Once again, all modulation happens 4 times faster, it's more than 4 bonus rows per table! Any modulation squished between those will let you achieve interesting results. On high speeds it more than 8-10!

## LSDj Version Overclock differences:

This works with all LSDj versions from from 2.6.0 (included) all the way up to the latest one available!

Guide was written in mind for v8 and above due to optimisations allowing for comfortable and stable use,
any version below that won't perform well 

### Pre-8.8.0 - ADSR Tempo Related Drift

While using version 8 I noticed that the ADSR envelope tends to not be consistent,
and "drifts" in relation to the engine's tempo.

```
To reproduce on LSDj (8.7.7):

- In Noise Channel create phrase with 16 steps of FD hihats
- Make ADSR for that instrument 61/00/--
- Set tempo to 195

The user might hear the ADSR getting slightly shorter or longer in a regular, LFO-like manner.
```

This behaviour is more noticeable when using the overclocked version.
This effect is mostly undesired and somewhat uncontrollable unless the user tunes the `TEMPO` *and* starts the song at a very specific moment (Though extremely not recommended)

Version 8.8.0 and onwards keeps the envelopes very stable, and it's drift is not an issue anymore

Use version 8.8.7 if you wish to retain the old ADSR system, that is compatible with plenty of emulators and all Gameboy consoles.

# Credits

ABOC and Chiptune Cafe<br>
Pain Perdu<br>
Aquellex<br>
DBOYD<br>
Lisa and Pator<br>
